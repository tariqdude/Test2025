---
/**
 * Card Component
 * Versatile card container with multiple variants
 * Full accessibility support for interactive cards
 */

export interface Props {
  /** Visual style variant */
  variant?:
    | 'default'
    | 'outline'
    | 'gradient'
    | 'glass'
    | 'elevated'
    | 'bordered';
  /** Padding size */
  size?: 'xs' | 'sm' | 'md' | 'lg' | 'xl';
  /** Additional CSS classes */
  className?: string;
  /** Makes card a link */
  href?: string;
  /** Enable hover effects */
  hover?: boolean;
  /** Accessible label for interactive cards */
  label?: string;
  /** Card role for semantic HTML */
  role?: 'article' | 'listitem' | 'region';
  /** ID for aria-labelledby */
  labelledBy?: string;
  /** Focus ring color */
  focusRing?: 'primary' | 'secondary' | 'accent';
}

const {
  variant = 'default',
  size = 'md',
  className = '',
  href,
  hover = false,
  label,
  role,
  labelledBy,
  focusRing = 'primary',
} = Astro.props;

const baseClasses =
  'rounded-xl transition-all duration-300 ease-in-out relative overflow-hidden';

const variants = {
  default:
    'bg-white dark:bg-neutral-800 border border-neutral-200 dark:border-neutral-700 shadow-lg',
  outline:
    'border-2 border-primary-200 dark:border-primary-700 bg-transparent hover:border-primary-400 dark:hover:border-primary-500',
  gradient:
    'bg-gradient-to-br from-primary-50 to-secondary-50 dark:from-primary-900/20 dark:to-secondary-900/20 border border-primary-200 dark:border-primary-700',
  glass:
    'bg-white/80 dark:bg-neutral-800/80 backdrop-blur-xl border border-white/20 dark:border-neutral-700/50 shadow-xl',
  elevated:
    'bg-white dark:bg-neutral-800 shadow-2xl shadow-neutral-900/10 dark:shadow-neutral-900/50',
  bordered:
    'bg-white dark:bg-neutral-800 border-2 border-neutral-300 dark:border-neutral-600 hover:border-primary-400 dark:hover:border-primary-500',
};

const sizes = {
  xs: 'p-3',
  sm: 'p-4',
  md: 'p-6',
  lg: 'p-8',
  xl: 'p-10',
};

const focusRings = {
  primary: 'focus-visible:ring-primary-500',
  secondary: 'focus-visible:ring-gray-500',
  accent: 'focus-visible:ring-accent-500',
};

const hoverEffects = hover
  ? 'hover:shadow-xl hover:shadow-primary-500/10 hover:-translate-y-1 cursor-pointer group'
  : '';

const interactiveClasses = href
  ? `focus-visible:outline-none focus-visible:ring-2 ${focusRings[focusRing]} focus-visible:ring-offset-2 dark:focus-visible:ring-offset-neutral-900`
  : '';

const classes = `${baseClasses} ${variants[variant]} ${sizes[size]} ${hoverEffects} ${interactiveClasses} ${className}`;

const Tag = href ? 'a' : 'div';

// Accessibility attributes
const accessibilityProps: Record<string, string | undefined> = {};
if (role) accessibilityProps.role = role;
if (label) accessibilityProps['aria-label'] = label;
if (labelledBy) accessibilityProps['aria-labelledby'] = labelledBy;
---

<Tag href={href} class={classes} {...accessibilityProps}>
  {/* Optional decorative gradient overlay for hover */}
  {
    hover && (
      <div
        class="absolute inset-0 bg-gradient-to-br from-primary-500/0 to-secondary-500/0 group-hover:from-primary-500/5 group-hover:to-secondary-500/5 transition-all duration-500 pointer-events-none"
        aria-hidden="true"
      />
    )
  }

  <div class="relative z-10">
    <slot />
  </div>
</Tag>
