---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import BaseHead from '../../components/BaseHead.astro';
import Footer from '../../components/Footer.astro';
import FormattedDate from '../../components/FormattedDate.astro';
import Header from '../../components/Header.astro';
import AdvancedCard from '../../components/ui/AdvancedCard.astro';
import ModernButton from '../../components/ui/ModernButton.astro';
import Grid from '../../components/ui/Grid.astro';
import AdvancedAnimate from '../../components/ui/AdvancedAnimate.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
			<AdvancedAnimate animation="morphIn">
				<AdvancedCard variant="glass" size="large" className="text-center mb-16">
					<h1 class="text-6xl font-bold bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 bg-clip-text text-transparent mb-6">
						Blog
					</h1>
					<p class="text-xl text-gray-600 dark:text-gray-300 leading-relaxed">
						Thoughts, stories, and ideas from our journey of innovation and discovery.
					</p>
				</AdvancedCard>
			</AdvancedAnimate>
			
			<section>
				<AdvancedAnimate animation="slideInUp" delay={200}>
					<div class="text-center mb-12">
						<h2 class="text-4xl font-bold text-gray-900 dark:text-white mb-4">Latest Articles</h2>
						<div class="w-24 h-1 bg-gradient-to-r from-indigo-500 to-purple-500 mx-auto rounded-full"></div>
					</div>
				</AdvancedAnimate>

				<Grid columns="3" gap="8" breakpoints={{ md: 1, lg: 2 }}>
					{posts.map((post, index) => (
						<AdvancedAnimate animation="morphIn" delay={index * 150}>
							<AdvancedCard 
								variant={index % 3 === 0 ? "gradient" : index % 3 === 1 ? "glass" : "neumorphism"} 
								size="medium" 
								hover={true} 
								className="h-full group"
							>
								<a href={`/Test2025/blog/${post.id}/`} class="block">
									{post.data.heroImage && (
										<div class="relative overflow-hidden rounded-lg mb-6">
											<Image 
												width={720} 
												height={360} 
												src={post.data.heroImage} 
												alt={post.data.title} 
												class="w-full h-48 object-cover transition-transform duration-500 group-hover:scale-110"
											/>
											<div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
										</div>
									)}
									
									<div class="space-y-4">
										<div class="flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400">
											<time datetime={post.data.pubDate.toISOString()}>
												<FormattedDate date={post.data.pubDate} />
											</time>
											<span>â€¢</span>
											<span class="px-2 py-1 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 rounded-full text-xs font-medium">
												Article
											</span>
										</div>
										
										<h3 class="text-xl font-bold text-gray-900 dark:text-white group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors duration-300">
											{post.data.title}
										</h3>
										
										{post.data.description && (
											<p class="text-gray-600 dark:text-gray-300 line-clamp-3">
												{post.data.description}
											</p>
										)}
									</div>
								</a>
								
								<div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
									<ModernButton 
										variant="glass" 
										size="small" 
										href={`/Test2025/blog/${post.id}/`}
										effect="glow"
										className="w-full"
									>
										Read More
										<svg class="w-4 h-4 ml-2 transition-transform duration-300 group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
											<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
										</svg>
									</ModernButton>
								</div>
							</AdvancedCard>
						</AdvancedAnimate>
					))}
				</Grid>
			</section>
		</main>
		<Footer />
	</body>
</html>
